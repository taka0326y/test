<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>英単語暗記チェックリスト｜Netflixシック</title>
  <meta name="theme-color" content="#141414">
  <style>
    :root {
      --bg: #141414;
      --panel: #1f1f1f;
      --panel-light: #2a2a2a;
      --text: #e5e5e5;
      --text-muted: #9a9a9a;
      --border: #2a2a2a;
      --accent: #E50914;
      --accent-light: #ff3b3b;
      --radius: 12px;
      --transition: 0.3s ease;
    }
    * {
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }
    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
      background: var(--bg);
      color: var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, "Hiragino Kaku Gothic ProN", "Yu Gothic", Meiryo, sans-serif;
      line-height: 1.6;
    }
    a {
      color: inherit;
      text-decoration: none;
    }

    header {
      position: sticky;
      top: 0;
      z-index: 10;
      background: rgba(20,20,20,0.9);
      backdrop-filter: blur(8px);
      border-bottom: 1px solid var(--border);
      padding: 16px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
    }
    .brand {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .logo {
      width: 24px;
      height: 32px;
      background: linear-gradient(180deg, var(--accent), var(--accent-light));
      border-radius: 4px;
      box-shadow: 0 8px 24px rgba(229,9,20,0.4);
    }
    .title {
      font-size: 1.25rem;
      font-weight: 700;
      letter-spacing: 0.5px;
    }
    .subtitle {
      font-size: 0.875rem;
      color: var(--text-muted);
    }
    .toolbar {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    .btn {
      padding: 8px 16px;
      font-weight: 600;
      border: none;
      border-radius: var(--radius);
      cursor: pointer;
      transition: transform var(--transition), background-color var(--transition);
      background-color: var(--accent);
      color: #fff;
      box-shadow: 0 4px 12px rgba(229,9,20,0.5);
    }
    .btn:hover {
      transform: translateY(-2px);
      background-color: var(--accent-light);
    }
    .btn.ghost {
      background-color: transparent;
      border: 1px solid var(--border);
      color: var(--text);
    }

    .container {
      max-width: 940px;
      margin: 24px auto;
      padding: 0 16px;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
    }

    .card {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      transition: box-shadow var(--transition), border-color var(--transition);
    }
    .card:hover {
      box-shadow: 0 10px 30px rgba(0,0,0,0.4);
      border-color: var(--panel-light);
    }
    .card header {
      padding: 16px;
      background: var(--panel-light);
      display: flex;
      align-items: center;
      justify-content: space-between;
      cursor: pointer;
      user-select: none;
    }
    .card header h2 {
      margin: 0;
      font-size: 1rem;
      font-weight: 600;
      letter-spacing: 0.3px;
    }
    .card header .h2-actions {
      display: flex;
      gap: 8px;
    }

    .chip {
      padding: 6px 12px;
      font-size: 0.875rem;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: var(--panel);
      color: var(--text);
      cursor: pointer;
      transition: background-color var(--transition), border-color var(--transition);
    }
    .chip.accent {
      background: var(--accent);
      border-color: var(--accent);
      color: #fff;
    }
    .chip:hover {
      background-color: var(--panel-light);
    }

    .list {
      list-style: none;
      margin: 0;
      padding: 0;
      overflow: hidden;
      transition: max-height var(--transition), opacity var(--transition);
    }
    .list.folded {
      max-height: 0;
      opacity: 0;
    }
    .list.open {
      opacity: 1;
      /* max-height large enough to contain all elements; or auto but CSS transition with auto is tricky */
      max-height: 1000px;
    }

    .row {
      display: grid;
      grid-template-columns: auto 1fr auto auto;
      align-items: center;
      gap: 8px;
      padding: 12px 16px;
      border-top: 1px solid var(--border);
      transition: background-color var(--transition), border-color var(--transition);
    }
    .row:first-child {
      border-top: none;
    }
    .row:hover {
      background-color: var(--panel-light);
    }
    .word {
      font-weight: 600;
      font-size: 1rem;
    }
    .ipa {
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      color: var(--text-muted);
      font-size: 0.875rem;
    }
    .jp {
      position: relative;
      font-size: 0.95rem;
      transition: opacity var(--transition);
    }
    .jp.covered {
      opacity: 0; /* 隠す */
    }

    .peel {
      position: absolute;
      left: 0;
      top: 0;
      pointer-events: none;
      background:
        radial-gradient(14px 14px at 100% 0%, rgba(0,0,0,0.25), transparent 60%),
        linear-gradient(135deg, #2a2a2a 0%, #1d1d1d 65%, #2a2a2a 100%);
      border: 1px solid #3a3a3a;
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.06), 0 12px 24px rgba(0,0,0,0.45);
      transform-origin: left top;
      opacity: 1;
    }

    .peel.run {
      animation: peelOff 0.6s cubic-bezier(0.25,0.8,0.25,1) forwards;
    }
    @keyframes peelOff {
      0% { transform: rotateX(0) rotateZ(0) translate(0,0); opacity: 1; }
      55% { transform: rotateX(30deg) rotateZ(-2deg) translate(-2px, -4px); }
      100% { transform: rotateX(70deg) rotateZ(-6deg) translate(-4px, -16px); opacity: 0; }
    }

    footer {
      max-width: 940px;
      margin: 40px auto;
      padding: 0 16px;
      color: var(--text-muted);
      font-size: 0.875rem;
      text-align: center;
    }

    @media (max-width: 600px) {
      .row {
        grid-template-columns: 1fr 1fr;
      }
      .ipa {
        order: 3;
      }
      .jp {
        order: 2;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <span class="logo"></span>
      <div>
        <div class="title">英単語暗記チェックリスト</div>
        <div class="subtitle">訳は各カテゴリ右上のボタンで表示／非表示できます</div>
      </div>
    </div>
    <div class="toolbar">
      <button class="btn" id="printBtn">印刷</button>
      <button class="btn ghost" id="resetBtn">全リセット</button>
    </div>
  </header>
  <main class="container">
    <div class="grid" id="grid"></div>
  </main>
  <footer>
    状態は自動保存（localStorage）。「覚えた」チェックで記憶。語彙は <code>initialData</code> を編集して追加できます。
  </footer>

  <script>
    const initialData = {
      "動詞":[
        { w:"acquire", ipa:"/əˈkwaɪər/", jp:"獲得する" },
        { w:"assume",  ipa:"/əˈsuːm/",  jp:"仮定する・引き受ける" },
        { w:"pursue",  ipa:"/pərˈsuː/",  jp:"追求する" }
      ],
      "形容詞":[
        { w:"subtle", ipa:"/ˈsʌt̬.əl/", jp:"微妙な・繊細な" },
        { w:"robust", ipa:"/roʊˈbʌst/", jp:"頑丈な・力強い" },
        { w:"feasible", ipa:"/ˈfiː.zə.bəl/", jp:"実行可能な" }
      ],
      "副詞":[
        { w:"roughly", ipa:"/ˈrʌf.li/", jp:"おおよそ" },
        { w:"literally", ipa:"/ˈlɪt̬.ər.əl.i/", jp:"文字通り" }
      ],
      "名詞":[
        { w:"insight", ipa:"/ˈɪn.saɪt/", jp:"洞察" },
        { w:"trajectory", ipa:"/trəˈdʒek.tər.i/", jp:"軌道・軌跡" }
      ],
      "前置詞":[
        { w:"beyond", ipa:"/biˈjɑːnd/", jp:"〜を超えて" },
        { w:"within", ipa:"/wɪˈðɪn/", jp:"〜以内に／〜の内側に" }
      ]
    };
    const ORDER = ["動詞","形容詞","副詞","名詞","前置詞"];
    const STORE_KEY = 'vocab-deck-v1';

    function loadState(){
      try {
        return JSON.parse(localStorage.getItem(STORE_KEY)) || {};
      } catch {
        return {};
      }
    }
    function saveState(s){
      localStorage.setItem(STORE_KEY, JSON.stringify(s));
    }
    const state = loadState();
    state.known = state.known || {};
    state.folded = state.folded || {};
    state.showJP = state.showJP || {};

    let lastToggle = { cat: null, toShow: false };

    function makeId(cat, w){
      return 'id-' + (cat + '-' + w).replace(/\s+/g, '-').replace(/[^\w\-]/g, '');
    }

    function render(){
      const grid = document.getElementById('grid');
      grid.innerHTML = '';
      ORDER.forEach(cat => {
        const section = document.createElement('section');
        section.className = 'card';
        if (state.folded[cat]) {
          section.classList.add('folded');
        }

        // カードのヘッダー
        const hdr = document.createElement('header');
        const h2 = document.createElement('h2');
        h2.textContent = cat;
        hdr.append(h2);

        const actions = document.createElement('div');
        actions.className = 'h2-actions';
        const toggleJP = document.createElement('span');
        toggleJP.className = 'chip accent';
        const show = !!state.showJP[cat];
        toggleJP.textContent = show ? '訳を隠す' : '訳を表示';
        toggleJP.onclick = (e) => {
          e.stopPropagation();
          state.showJP[cat] = !state.showJP[cat];
          lastToggle = { cat, toShow: state.showJP[cat] };
          saveState(state);
          render();
        };
        actions.append(toggleJP);
        hdr.append(actions);

        hdr.onclick = () => {
          state.folded[cat] = !state.folded[cat];
          saveState(state);
          render();
        };

        section.append(hdr);

        const ul = document.createElement('ul');
        ul.className = 'list';
        if (state.folded[cat]) {
          ul.classList.add('folded');
        } else {
          ul.classList.add('open');
        }

        (initialData[cat] || []).forEach((item, idx) => {
          const li = document.createElement('li');
          li.className = 'row';

          const id = makeId(cat, item.w);
          const cb = document.createElement('input');
          cb.type = 'checkbox';
          cb.id = id;
          cb.checked = !!state.known[item.w];
          cb.onchange = () => {
            state.known[item.w] = cb.checked;
            saveState(state);
          };

          const word = document.createElement('div');
          word.className = 'word';
          word.textContent = item.w;

          const ipa = document.createElement('div');
          ipa.className = 'ipa';
          ipa.textContent = item.ipa || '';

          const jp = document.createElement('div');
          jp.className = 'jp' + (state.showJP[cat] ? '' : ' covered');
          jp.textContent = item.jp || '';

          li.append(cb, word, ipa, jp);
          ul.append(li);
        });

        section.append(ul);
        grid.append(section);

        if (lastToggle.cat === cat && lastToggle.toShow) {
          peelReveal(ul);
        }
      });
    }

    function peelReveal(container) {
      const targets = container.querySelectorAll('.jp');
      targets.forEach((jp, idx) => {
        jp.querySelectorAll('.peel').forEach(n => n.remove());
        const rect = jp.getBoundingClientRect();
        const peel = document.createElement('span');
        peel.className = 'peel';
        peel.style.width = rect.width + 'px';
        peel.style.height = rect.height + 'px';
        peel.style.left = '0px';
        peel.style.top = '0px';
        peel.style.animationDelay = (idx * 40) + 'ms';
        jp.appendChild(peel);
        jp.classList.remove('covered');
        requestAnimationFrame(() => {
          peel.classList.add('run');
        });
        peel.addEventListener('animationend', () => {
          peel.remove();
        }, { once: true });
      });
    }

    render();

    document.getElementById('printBtn').onclick = () => {
      window.print();
    };
    document.getElementById('resetBtn').onclick = () => {
      if (confirm('全リセットしますか？（開閉・チェック・表示状態すべて）')) {
        localStorage.removeItem(STORE_KEY);
        location.reload();
      }
    };
  </script>
</body>
</html>
