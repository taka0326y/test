<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>英単語暗記チェック</title>
  <meta name="theme-color" content="#7aa387">

  <!-- ✅ 発音記号対応フォント -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;700&family=Noto+Serif:wght@400;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#f8f7f4; --paper:#fffefa; --ink:#2a2f27;
      --muted:#888f86; --line:#e6e4dd;
      --accent:#7aa387; --accent-deep:#5f8c71;
      --chip:#eef3ef; --radius:18px;
      --shadow:0 10px 28px rgba(0,0,0,.06);
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:"Noto Sans", "Noto Sans JP", system-ui, sans-serif;
      background:linear-gradient(180deg,var(--bg),#fff);
      color:var(--ink); letter-spacing:.02em;
    }
    .wrap{max-width:970px; margin:22px auto 64px; padding:0 16px}

    header{
      position:sticky; top:0; z-index:10;
      backdrop-filter:blur(6px);
      background:rgba(255,255,255,.65);
      border-bottom:1px solid var(--line);
    }
    .head-inner{display:flex; align-items:center; justify-content:space-between; gap:12px; padding:14px 16px}
    .title{display:flex; align-items:baseline; gap:10px}
    h1{margin:0; font-size:clamp(20px,3.4vw,28px)}
    .tag{font-size:12px; color:var(--muted)}
    .toolbar{display:flex; gap:8px; flex-wrap:wrap}
    .btn{border:1px solid var(--line); background:#fff; color:var(--accent);
      padding:8px 12px; border-radius:999px; font-weight:700; cursor:pointer;
      box-shadow:0 2px 10px rgba(0,0,0,.04)}
    .btn:hover{transform:translateY(-1px); box-shadow:0 8px 16px rgba(0,0,0,.08)}

    .grid{display:flex; flex-direction:column; gap:16px}
    .card{background:var(--paper); border:1px solid var(--line); border-radius:var(--radius); box-shadow:var(--shadow)}
    .card-head{display:flex; align-items:center; gap:12px; padding:12px 14px; position:relative}
    .card-title{margin:0; font-size:16px; color:var(--accent-deep); cursor:pointer; user-select:none}
    .chev{margin-left:auto; color:var(--accent); font-size:12px; opacity:.8; pointer-events:none}
    .card.fold .chev{transform:rotate(-90deg); opacity:.6}
    .h2-actions{margin-left:auto; margin-right:28px; display:flex; align-items:center; gap:8px}
    .chip{background:var(--chip); color:var(--accent-deep); border:1px solid var(--line);
      padding:6px 12px; border-radius:999px; font-size:12px; cursor:pointer}
    .chip:hover{filter:brightness(.98)}

    .list{list-style:none; margin:0; padding:8px 12px 14px; border-top:1px dashed var(--line)}
    .list.fold{display:none}
    .row{display:grid; grid-template-columns:24px 1.1fr .9fr 1fr;
      gap:10px; align-items:center; padding:10px 10px; border:1px dashed var(--line);
      border-radius:14px; background:#fff; margin-top:8px}
    .row:hover{border-color:#d8e3db; box-shadow:0 6px 14px rgba(0,0,0,.04)}
    input[type="checkbox"]{width:18px; height:18px; accent-color:var(--accent); cursor:pointer}
    .en{font-weight:700}
    .ipa{
      font-family:"Noto Sans","Noto Serif","Segoe UI Symbol",
                   "Arial Unicode MS","Noto Sans JP",system-ui,sans-serif;
      color:#4f5a51; font-size:.95em;
    }
    .ja{color:#364239}
    .card.hide-ja .ja{display:none}
    .card.hide-ja .chip[data-role="toggle-ja"]{opacity:.85}

    @media (max-width:640px){
      .row{grid-template-columns:24px 1fr; grid-template-rows:auto auto auto}
      .en{grid-column:2/3}
      .ipa{grid-column:2/3}
      .ja{grid-column:2/3}
    }
    @media print{header{display:none} .row{break-inside:avoid} body{background:#fff}}
  </style>
</head>
<body>
  <header>
    <div class="head-inner">
      <div class="title">
        <h1>英単語暗記チェック</h1>
        <span class="tag">IPA対応</span>
      </div>
      <div class="toolbar">
        <button class="btn" id="printBtn">印刷</button>
        <button class="btn" id="resetBtn">全リセット</button>
      </div>
    </div>
  </header>

  <main class="wrap">
    <section class="grid" id="grid"></section>
  </main>

  <script>
    const initialData = {
      "動詞": [
        { en:"acquire", ipa:"/əˈkwaɪər/", ja:"獲得する" },
        { en:"refine", ipa:"/rɪˈfaɪn/", ja:"磨きをかける" },
        { en:"assume", ipa:"/əˈsuːm/", ja:"仮定する・引き受ける" }
      ],
      "形容詞": [
        { en:"subtle", ipa:"/ˈsʌt(ə)l/", ja:"微妙な・巧みな" },
        { en:"robust", ipa:"/roʊˈbʌst/", ja:"頑丈な・強固な" },
        { en:"aesthetic", ipa:"/iːsˈθetɪk/", ja:"美的な" }
      ],
      "副詞": [
        { en:"barely", ipa:"/ˈbɛərli/", ja:"かろうじて" },
        { en:"literally", ipa:"/ˈlɪtərəli/", ja:"文字通り" },
        { en:"eventually", ipa:"/ɪˈvɛntʃuəli/", ja:"最終的に" }
      ],
      "名詞": [
        { en:"remedy", ipa:"/ˈrɛmədi/", ja:"治療法・解決策" },
        { en:"staple", ipa:"/ˈsteɪpəl/", ja:"主要な商品・主食" },
        { en:"venue", ipa:"/ˈvɛnjuː/", ja:"会場" }
      ],
      "前置詞": [
        { en:"despite", ipa:"/dɪˈspaɪt/", ja:"〜にもかかわらず" },
        { en:"beyond", ipa:"/bɪˈjɒnd/", ja:"〜を越えて" },
        { en:"within", ipa:"/wɪˈðɪn/", ja:"〜の内側に／以内に" }
      ]
    };

    const ORDER = Object.keys(initialData);
    const STORE_KEY = 'vocab-checklist-kcafe-v2';
    const load = () => { try { return JSON.parse(localStorage.getItem(STORE_KEY))||{} } catch { return {} } };
    const save = s => localStorage.setItem(STORE_KEY, JSON.stringify(s));
    const state = load();
    if(!state.checked) state.checked = {};
    if(!state.folded) state.folded = {};
    if(!state.showJa) state.showJa = {};

    function render(){
      const grid = document.getElementById('grid');
      grid.innerHTML = '';
      ORDER.forEach(cat=>{
        const card=document.createElement('section');
        card.className='card';
        if(state.showJa[cat]===false)card.classList.add('hide-ja');

        const head=document.createElement('div');
        head.className='card-head';

        const h=document.createElement('h2');
        h.className='card-title';
        h.textContent=cat;
        h.onclick=()=>{state.folded[cat]=!state.folded[cat]; save(state); render();};

        const actions=document.createElement('div');
        actions.className='h2-actions';

        const toggleJa=document.createElement('button');
        toggleJa.className='chip';
        toggleJa.dataset.role='toggle-ja';
        const visible=state.showJa[cat]!==false;
        toggleJa.textContent=visible?'訳を隠す':'訳を表示';
        toggleJa.onclick=(e)=>{
          e.stopPropagation();
          state.showJa[cat]=!(state.showJa[cat]!==false);
          save(state); render();
        };

        const chev=document.createElement('span');
        chev.className='chev';
        chev.textContent='▼';

        actions.append(toggleJa);
        head.append(h,actions,chev);

        const ul=document.createElement('ul');
        ul.className='list';
        if(state.folded[cat])ul.classList.add('fold');

        initialData[cat].forEach(v=>{
          const key=cat+'::'+v.en;
          const li=document.createElement('li');
          li.className='row';

          const cb=document.createElement('input');
          cb.type='checkbox';
          cb.checked=!!state.checked[key];
          cb.onchange=()=>{state.checked[key]=cb.checked; save(state)};

          const en=document.createElement('div');
          en.className='en';
          en.textContent=v.en;

          const ipa=document.createElement('div');
          ipa.className='ipa';
          ipa.textContent=v.ipa||'';

          const ja=document.createElement('div');
          ja.className='ja';
          ja.textContent=v.ja||'';

          li.append(cb,en,ipa,ja);
          ul.append(li);
        });

        card.append(head,ul);
        if(state.folded[cat])card.classList.add('fold');
        grid.append(card);
      });
    }
    render();

    document.getElementById('printBtn').onclick=()=>window.print();
    document.getElementById('resetBtn').onclick=()=>{
      if(confirm('全リセットしますか？\\nチェック・開閉・訳表示が消えます')){
        localStorage.removeItem(STORE_KEY);
        location.reload();
      }
    };
  </script>
</body>
</html>